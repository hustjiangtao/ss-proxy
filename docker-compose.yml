version: "3"
services:
  v2ray:
      restart: always
      image: v2fly/v2fly-core:v4.45.2
      volumes:
          - ./v2ray/config.json:/etc/v2ray/config.json
      expose:
          - "8001" # if you need to change this you should change Caddyfile as well

  caddy:
    container_name: caddy
    build: .
    restart: unless-stopped
    ports:
      - "80:80"
      - "443:443"
      - "443:443/udp"
    volumes:
      - $PWD/caddy:/etc/caddy:ro
      - $PWD/log/caddy:/var/log
    restart: unless-stopped
    sysctls:
      - net.ipv4.tcp_congestion_control=bbr